import{S as W,i as X,s as Y,e as _,k as A,t as B,c as b,a as p,d,n as C,g as D,R as Z,b as g,f as S,D as h,F as U,u as L,w as x,x as w,A as se,r as ee,j as z,m as F,o as G,v as H,h as re,T as ae,U as ne,E as te}from"../chunks/vendor-f1fad890.js";import{E as ie}from"../chunks/Error-103e9442.js";function ce(a){let e,o,t,s,l,i,k,n,m,y,q,v,I,u,P,r,c,f,$,V;return{c(){e=_("div"),o=_("a"),t=_("div"),s=_("div"),l=_("img"),k=A(),n=_("div"),m=_("p"),y=B(a[3]),q=A(),v=_("p"),I=B("by "),u=_("i"),P=B(a[2]),r=A(),c=_("p"),f=B(a[4]),$=B(", "),V=B(a[5]),this.h()},l(E){e=b(E,"DIV",{class:!0});var j=p(e);o=b(j,"A",{href:!0});var J=p(o);t=b(J,"DIV",{class:!0});var M=p(t);s=b(M,"DIV",{});var R=p(s);l=b(R,"IMG",{src:!0,alt:!0}),R.forEach(d),k=C(M),n=b(M,"DIV",{});var T=p(n);m=b(T,"P",{class:!0});var K=p(m);y=D(K,a[3]),K.forEach(d),q=C(T),v=b(T,"P",{class:!0});var O=p(v);I=D(O,"by "),u=b(O,"I",{});var Q=p(u);P=D(Q,a[2]),Q.forEach(d),O.forEach(d),r=C(T),c=b(T,"P",{});var N=p(c);f=D(N,a[4]),$=D(N,", "),V=D(N,a[5]),N.forEach(d),T.forEach(d),M.forEach(d),J.forEach(d),j.forEach(d),this.h()},h(){Z(l.src,i="https://books.google.com/books/content?id="+a[0])||g(l,"src",i),g(l,"alt","cover"),g(m,"class","title"),g(v,"class","author"),g(t,"class","book-card-container"),g(o,"href",a[1]),g(e,"class","book-card")},m(E,j){S(E,e,j),h(e,o),h(o,t),h(t,s),h(s,l),h(t,k),h(t,n),h(n,m),h(m,y),h(n,q),h(n,v),h(v,I),h(v,u),h(u,P),h(n,r),h(n,c),h(c,f),h(c,$),h(c,V)},p(E,[j]){j&1&&!Z(l.src,i="https://books.google.com/books/content?id="+E[0])&&g(l,"src",i)},i:U,o:U,d(E){E&&d(e)}}}function ue(a,e,o){let{book:t}=e,s=`/books/${t.id}`,l=t.volumeInfo.authors?t.volumeInfo.authors[0]:"Unknown",i;t.volumeInfo.imageLinks?i=t.volumeInfo.imageLinks.thumbnail.split("http://books.google.com/books/content?id=")[1]:i="https://bookstoreromanceday.org/wp-content/uploads/2020/08/book-cover-placeholder.png";let k=t.volumeInfo.title,n=t.volumeInfo.publisher,m=t.volumeInfo.publishedDate?t.volumeInfo.publishedDate.split("-")[0]:"Unknown";return a.$$set=y=>{"book"in y&&o(6,t=y.book)},[i,s,l,k,n,m,t]}class fe extends W{constructor(e){super();X(this,e,ue,ce,Y,{book:6})}}function oe(a,e,o){const t=a.slice();return t[4]=e[o],t}function de(a){let e,o;return e=new ie({}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){G(e,t,s),o=!0},p:U,i(t){o||(w(e.$$.fragment,t),o=!0)},o(t){L(e.$$.fragment,t),o=!1},d(t){H(e,t)}}}function he(a){let e,o,t,s,l,i,k,n,m;function y(r,c){return r[2]=="list"?be:_e}let q=y(a),v=q(a),I=a[0],u=[];for(let r=0;r<I.length;r+=1)u[r]=le(oe(a,I,r));const P=r=>L(u[r],1,1,()=>{u[r]=null});return{c(){e=_("div"),o=_("h1"),t=B("Search results for: "),s=B(a[1]),l=A(),i=_("div"),v.c(),k=A(),n=_("div");for(let r=0;r<u.length;r+=1)u[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0});var c=p(e);o=b(c,"H1",{});var f=p(o);t=D(f,"Search results for: "),s=D(f,a[1]),f.forEach(d),l=C(c),i=b(c,"DIV",{});var $=p(i);v.l($),$.forEach(d),c.forEach(d),k=C(r),n=b(r,"DIV",{id:!0,class:!0});var V=p(n);for(let E=0;E<u.length;E+=1)u[E].l(V);V.forEach(d),this.h()},h(){g(e,"class","title-bar"),g(n,"id","books"),g(n,"class","book-list layout-list")},m(r,c){S(r,e,c),h(e,o),h(o,t),h(o,s),h(e,l),h(e,i),v.m(i,null),S(r,k,c),S(r,n,c);for(let f=0;f<u.length;f+=1)u[f].m(n,null);m=!0},p(r,c){if((!m||c&2)&&re(s,r[1]),q===(q=y(r))&&v?v.p(r,c):(v.d(1),v=q(r),v&&(v.c(),v.m(i,null))),c&1){I=r[0];let f;for(f=0;f<I.length;f+=1){const $=oe(r,I,f);u[f]?(u[f].p($,c),w(u[f],1)):(u[f]=le($),u[f].c(),w(u[f],1),u[f].m(n,null))}for(ee(),f=I.length;f<u.length;f+=1)P(f);x()}},i(r){if(!m){for(let c=0;c<I.length;c+=1)w(u[c]);m=!0}},o(r){u=u.filter(Boolean);for(let c=0;c<u.length;c+=1)L(u[c]);m=!1},d(r){r&&d(e),v.d(),r&&d(k),r&&d(n),ae(u,r)}}}function me(a){let e,o,t;return o=new ne({props:{size:"120",color:"#f2b3cf",unit:"px",duration:"1s"}}),{c(){e=_("div"),z(o.$$.fragment),this.h()},l(s){e=b(s,"DIV",{class:!0});var l=p(e);F(o.$$.fragment,l),l.forEach(d),this.h()},h(){g(e,"class","loader")},m(s,l){S(s,e,l),G(o,e,null),t=!0},p:U,i(s){t||(w(o.$$.fragment,s),t=!0)},o(s){L(o.$$.fragment,s),t=!1},d(s){s&&d(e),H(o)}}}function _e(a){let e,o,t,s;return{c(){e=_("button"),o=_("i"),this.h()},l(l){e=b(l,"BUTTON",{class:!0});var i=p(e);o=b(i,"I",{class:!0}),p(o).forEach(d),i.forEach(d),this.h()},h(){g(o,"class","fas fa-th-list"),g(e,"class","toolsButton")},m(l,i){S(l,e,i),h(e,o),t||(s=te(e,"click",a[3]),t=!0)},p:U,d(l){l&&d(e),t=!1,s()}}}function be(a){let e,o,t,s;return{c(){e=_("button"),o=_("i"),this.h()},l(l){e=b(l,"BUTTON",{class:!0});var i=p(e);o=b(i,"I",{class:!0}),p(o).forEach(d),i.forEach(d),this.h()},h(){g(o,"class","fas fa-th"),g(e,"class","toolsButton")},m(l,i){S(l,e,i),h(e,o),t||(s=te(e,"click",a[3]),t=!0)},p:U,d(l){l&&d(e),t=!1,s()}}}function le(a){let e,o;return e=new fe({props:{book:a[4]}}),{c(){z(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){G(e,t,s),o=!0},p(t,s){const l={};s&1&&(l.book=t[4]),e.$set(l)},i(t){o||(w(e.$$.fragment,t),o=!0)},o(t){L(e.$$.fragment,t),o=!1},d(t){H(e,t)}}}function ve(a){let e,o,t,s;const l=[me,he,de],i=[];function k(n,m){return n[0]?n[0].error?2:1:0}return o=k(a),t=i[o]=l[o](a),{c(){e=_("div"),t.c(),this.h()},l(n){e=b(n,"DIV",{id:!0});var m=p(e);t.l(m),m.forEach(d),this.h()},h(){g(e,"id","book-list-container")},m(n,m){S(n,e,m),i[o].m(e,null),s=!0},p(n,[m]){let y=o;o=k(n),o===y?i[o].p(n,m):(ee(),L(i[y],1,1,()=>{i[y]=null}),x(),t=i[o],t?t.p(n,m):(t=i[o]=l[o](n),t.c()),w(t,1),t.m(e,null))},i(n){s||(w(t),s=!0)},o(n){L(t),s=!1},d(n){n&&d(e),i[o].d()}}}async function ye({page:a}){const e=a.query.get("q");let o;try{o=await(await fetch("./api/bookSearch?q="+e)).json(),o=o.results}catch{o=null}return{props:{data:o,query:e}}}function pe(a,e,o){let{data:t=[],query:s}=e,l;se(()=>{localStorage.getItem("layout")?o(2,l=localStorage.getItem("layout")):o(2,l="list"),l=="grid"&&(document.getElementById("books").classList.remove("layout-list"),document.getElementById("books").classList.add("layout-grid"))});function i(){l=="list"?(o(2,l="grid"),localStorage.setItem("layout","grid"),document.getElementById("books").classList.remove("layout-list"),document.getElementById("books").classList.add("layout-grid")):(o(2,l="list"),localStorage.setItem("layout","list"),document.getElementById("books").classList.add("layout-list"),document.getElementById("books").classList.remove("layout-grid"))}return a.$$set=k=>{"data"in k&&o(0,t=k.data),"query"in k&&o(1,s=k.query)},[t,s,l,i]}class Ie extends W{constructor(e){super();X(this,e,pe,ve,Y,{data:0,query:1})}}export{Ie as default,ye as load};
